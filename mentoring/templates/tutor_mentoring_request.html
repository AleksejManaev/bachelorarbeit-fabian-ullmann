{% extends "base_portal.html" %}
{% load material %}
{% load filter %}

{% block material_content %}

    <div class="row">
        <div class="col s12">
            <div class="card">
                <div class="card-header">
                    <span class="card-title blue-grey-text">{{ object.from_student }}<br/><small>{{ object.from_student.course }}</small></span>
                </div>
                <div class="card-content">
                    <div class="row">
                        <div class="col s12">
                            <p>{{ object.comment|linebreaksbr }}</p>
                        </div>
                    </div>
                    <div class="divider"></div>
                    <div class="row">
                        <div class="col s12">
                            <p>{{ object.thesis.description|linebreaksbr }}</p>
                        </div>
                    </div>
                    <div class="row grey lighten-5">
                        <div class="col s8">
                            <b>{{ object.thesis.workcompany.company }}</b>
                            {# TODO Link zu CompanyWorks  #}
                            ({{ object.thesis.workcompany.company.works|length|add:-1 }})
                            <ul>
                                <li><i> {{ object.thesis.workcompany.description|linebreaksbr }}</i></li>
                            </ul>
                        </div>
                        <div class="col s4">
                            <b>{{ object.thesis.workcompany.companycontactdata.title }} {{ object.thesis.workcompany.companycontactdata.first_name }} {{ object.thesis.workcompany.companycontactdata.last_name }}</b>
                            <ul>
                                <li><i class="mdi-content-mail"></i> <a
                                        href="mailto:{{ object.thesis.workcompany.companycontactdata.email }}"> {{ object.thesis.workcompany.companycontactdata.email }}</a>
                                </li>
                                <li>
                                    <i class="mdi-communication-phone"></i> {{ object.thesis.workcompany.companycontactdata.phone }}
                                </li>
                            </ul>
                        </div>
                    </div>

                </div>

                <form action="{% if object.status == 'RE' %}{{ form_action }}{% endif %}" method="post"
                      class="col s12 grey lighten-4"
                      style="border-top: 1px #607d8b solid">
                    {% csrf_token %}
                    {% material_formfield mentoringrequest_form.answer %}
                    <div class="row">
                        <div class="col">&nbsp;</div>
                    </div>
                    <div class="input-group">
                        <span class="card-title blue-grey-text">Tutor 2</span>
                        {% material_form mentoringrequest_tutor2_form %}
                        {% material_formfield mentoringrequest_form.permission %}
                    </div>
                    <div class="row">
                        <div class="col">&nbsp;</div>
                    </div>
                    {% if not object.status == 'RE' %}
                        {% material_divider %}
                        {% if object.status == 'AC' %}
                            <span class="green-text">{{ object.status|state }} on {{ object.mentoring.created_on|date }}</span>
                        {% else %}
                            <span class="red-text">{{ object.status|state }}</span>
                        {% endif %}
                    {% else %}
                        <div class="card-action acceptdeny">
                            <div class="col s6 green white-text valign-wrapper">
                                <button type="submit" name="accept">Accept</button>
                            </div>
                            <div class="col s6 red white-text valign-wrapper">
                                <button type="submit" name="deny">Deny</button>
                            </div>
                        </div>
                    {% endif %}
                </form>

            </div>
        </div>
    </div>


    <form action="{{ form_action }}" method="post" reveal-name="accept" class="col s12">
        {% csrf_token %}

    </form>
{% endblock %}


{% block material_extra_script %}
    <script type="text/javascript">
        $(document).ready(function () {
        })
    </script>

{% endblock %}